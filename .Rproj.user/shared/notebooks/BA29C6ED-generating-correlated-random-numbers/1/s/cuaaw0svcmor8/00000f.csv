"0","#| label: correlation-comparison"
"0",""
"0","# What happens with already correlated input?"
"0","simulate_correlation <- function(input_correlation, target = 0.3) {"
"0","  results <- replicate(1000, {"
"0","    # Create input with specified correlation"
"0","    x <- rnorm(1000)"
"0","    y <- input_correlation * x + rnorm(1000, sd = sqrt(1 - input_correlation^2))"
"0","    "
"0","    # Apply our method"
"0","    old_random <- cbind(x, y)"
"0","    chol_mat <- chol(matrix(c(1, target, target, 1), ncol = 2))"
"0","    new_random <- old_random %*% chol_mat"
"0","    "
"0","    # Return resulting correlation"
"0","    cor(new_random)[1,2]"
"0","  })"
"0","  return(results)"
"0","}"
"0",""
"0","# Compare results with different input correlations"
"0","#par(mfrow = c(1, 2))"
"0",""
"0","plot(density(simulate_correlation(0.8), target = 0.3))"
