"0","#| label: setup-training"
"0",""
"0","# Loss functions"
"0","regression_loss_fn <- nnf_mse_loss  # Mean squared error for regression"
"0","classification_loss_fn <- nnf_binary_cross_entropy_with_logits  # Binary cross-entropy for classification"
"0",""
"0","# Optimizer with weight decay for L2 regularization"
"0","optimizer <- optim_adam(model$parameters, lr = 0.01)"
"0",""
"0","# Task weights - these control the relative importance of each task"
"0","task_weights <- c(regression = 0.5, classification = 0.5)"
"0",""
"0","# Validation split from training data"
"0","val_size <- round(0.2 * length(train_idx))"
"0","val_indices <- sample(train_idx, val_size)"
"0","train_indices <- setdiff(train_idx, val_indices)"
"0",""
"0","# Create validation sets"
"0","x_val <- x[val_indices, ]"
"0","y_reg_val <- y_regression[val_indices]"
"0","y_cls_val <- y_classification[val_indices]"
"0",""
"0","# Update training sets"
"0","x_train <- x[train_indices, ]"
"0","y_reg_train <- y_regression[train_indices]"
"0","y_cls_train <- y_classification[train_indices]"
