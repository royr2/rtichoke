"0","#| label: generate-data"
"0",""
"0","# Set seed for reproducibility"
"0","set.seed(123)"
"0",""
"0","# Number of samples"
"0","n <- 1000"
"0",""
"0","# Create a dataset with 5 features"
"0","x <- torch_randn(n, 5)"
"0",""
"0","# Task 1 (Regression): Predict continuous value"
"0","# Create a target that's a function of the input features plus some noise"
"0","y_regression <- x[, 1] * 0.7 + x[, 2] * 0.3 - x[, 3] * 0.5 + torch_randn(n) * 0.2"
"0",""
"0","# Task 2 (Classification): Predict binary outcome"
"0","# Create a classification target based on a nonlinear combination of features"
"0","logits <- x[, 1] * 0.8 - x[, 4] * 0.4 + x[, 5] * 0.6"
"0","y_classification <- (logits > 0)$to(torch_float())"
"0",""
"0","# Split into training (70%) and testing (30%) sets"
"0","train_idx <- 1:round(0.7 * n)"
"0","test_idx <- (round(0.7 * n) + 1):n"
"0",""
"0","# Training data"
"0","x_train <- x[train_idx, ]"
"0","y_reg_train <- y_regression[train_idx]"
"0","y_cls_train <- y_classification[train_idx]"
"0",""
"0","# Testing data"
"0","x_test <- x[test_idx, ]"
"0","y_reg_test <- y_regression[test_idx]"
"0","y_cls_test <- y_classification[test_idx]"
