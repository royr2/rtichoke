"0","#| label: define-network"
"0",""
"0","# Define the multi-task neural network"
"0","multi_task_net <- nn_module("
"0","  ""MultiTaskNet"","
"0","  "
"0","  initialize = function(input_size, "
"0","                        hidden_size, "
"0","                        reg_output_size = 1, "
"0","                        cls_output_size = 1) {"
"0","    "
"0","    self$input_size <- input_size"
"0","    self$hidden_size <- hidden_size"
"0","    self$reg_output_size <- reg_output_size"
"0","    self$cls_output_size <- cls_output_size"
"0","    "
"0","    # Shared layers - these learn representations useful for both tasks"
"0","    self$shared_layer1 <- nn_linear(input_size, hidden_size)"
"0","    self$shared_layer2 <- nn_linear(hidden_size, hidden_size)"
"0","    "
"0","    # Task-specific layers"
"0","    # Regression branch"
"0","    self$regression_layer <- nn_linear(hidden_size, reg_output_size)"
"0","    "
"0","    # Classification branch"
"0","    self$classification_layer <- nn_linear(hidden_size, cls_output_size)"
"0","  },"
"0","  "
"0","  forward = function(x) {"
"0","    # Shared feature extraction"
"0","    shared_features <- x %>%"
"0","      self$shared_layer1() %>%"
"0","      nnf_relu() %>%"
"0","      self$shared_layer2() %>%"
"0","      nnf_relu()"
"0","    "
"0","    # Task-specific predictions"
"0","    regression_output <- self$regression_layer(shared_features)"
"0","    classification_logits <- self$classification_layer(shared_features)"
"0","    "
"0","    list("
"0","      regression = regression_output,"
"0","      classification = classification_logits"
"0","    )"
"0","  }"
"0",")"
"0",""
"0","# Create model instance"
"0","model <- multi_task_net("
"0","  input_size = 5,"
"0","  hidden_size = 10"
"0",")"
"0",""
"0","# Print model architecture"
"0","print(model)"
"1","An `nn_module` containing 192 parameters."
"1",""
"1","
"
"1",""
"1",""
"1","
"
"1","── Modules ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────"
"1",""
"1","
"
"1","• shared_layer1: <nn_linear> #60 parameters"
"1",""
"1","
"
"1","• shared_layer2: <nn_linear> #110 parameters"
"1",""
"1","
"
"1","• regression_layer: <nn_linear> #11 parameters"
"1",""
"1","
"
"1","• classification_layer: <nn_linear> #11 parameters"
"1",""
"1","
"
