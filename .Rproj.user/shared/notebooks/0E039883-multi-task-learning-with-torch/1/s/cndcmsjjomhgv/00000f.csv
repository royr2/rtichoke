"0","#| label: generate-data"
"0",""
"0","# Set seed for reproducibility"
"0","set.seed(123)"
"0",""
"0","# Number of samples"
"0","n <- 1000"
"0",""
"0","# Create a dataset with 5 features"
"0","x <- torch_randn(n, 5)"
"0",""
"0","# Task 1 (Regression): Predict continuous value"
"0","# Create a target that's a function of the input features plus some noise"
"0","y_regression <- x[, 1] * 0.7 + x[, 2] * 0.3 - x[, 3] * 0.5 + torch_randn(n) * 0.2"
"0",""
"0","# Task 2 (Classification): Predict binary outcome"
"0","# Create a classification target based on a nonlinear combination of features"
"0","logits <- x[, 1] * 0.8 - x[, 4] * 0.4 + x[, 5] * 0.6"
"0","y_classification <- (logits > 0)$to(torch_float())"
"0",""
"0","# Display data summary"
"0","cat(""Dataset created with"", n, ""samples and 5 features\n"")"
"1","Dataset created with"
"1"," "
"1","1000"
"1"," "
"1","samples and 5 features
"
"0","cat(""Regression target range:"", round(as.numeric(y_regression$min()), 3), ""to"", round(as.numeric(y_regression$max()), 3), ""\n"")"
"1","Regression target range:"
"1"," "
"1","-2.904"
"1"," "
"1","to"
"1"," "
"1","3.637"
"1"," "
"1","
"
"0","cat(""Classification target distribution:"", "
"0","    round(as.numeric(y_classification$mean()), 3), ""positive class ratio\n"")"
"1","Classification target distribution:"
"1"," "
"1","0.486"
"1"," "
"1","positive class ratio
"
"0","# Split into training (70%) and testing (30%) sets"
"0","train_idx <- 1:round(0.7 * n)"
"0","test_idx <- (round(0.7 * n) + 1):n"
"0",""
"0","# Training data"
"0","x_train <- x[train_idx, ]"
"0","y_reg_train <- y_regression[train_idx]"
"0","y_cls_train <- y_classification[train_idx]"
"0",""
"0","# Testing data"
"0","x_test <- x[test_idx, ]"
"0","y_reg_test <- y_regression[test_idx]"
"0","y_cls_test <- y_classification[test_idx]"
"0",""
"0","cat(""Training samples:"", length(train_idx), ""\n"")"
"1","Training samples:"
"1"," "
"1","700"
"1"," "
"1","
"
"0","cat(""Testing samples:"", length(test_idx), ""\n"")"
"1","Testing samples:"
"1"," "
"1","300"
"1"," "
"1","
"
