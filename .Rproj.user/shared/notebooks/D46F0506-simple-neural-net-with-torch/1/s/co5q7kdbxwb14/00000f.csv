"0","#| label: training-loop"
"0",""
"0","# Store loss values for plotting"
"0","loss_history <- numeric(300)"
"0",""
"0","# Training loop"
"0","for(epoch in 1:300) {"
"0","  "
"0","  # Set model to training mode"
"0","  model$train()"
"0","  "
"0","  # Reset gradients"
"0","  optimizer$zero_grad()"
"0","  "
"0","  # Forward pass"
"0","  y_pred <- model(x)"
"0","  "
"0","  # Calculate loss"
"0","  loss <- loss_fn(y_pred, y)"
"0","  "
"0","  # Backward pass"
"0","  loss$backward()"
"0","  "
"0","  # Update parameters"
"0","  optimizer$step()"
"0","  "
"0","  # Store loss for plotting"
"0","  loss_history[epoch] <- loss$item()"
"0","}"
