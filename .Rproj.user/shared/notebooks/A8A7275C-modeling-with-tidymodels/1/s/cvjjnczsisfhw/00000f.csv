"0","set.seed(123)"
"0","n <- 10000  # Larger sample size for more realistic modeling"
"0",""
"0","# Create base features with realistic distributions"
"0","data <- tibble("
"0","  customer_id = paste0(""CUS"", formatC(1:n, width = 6, format = ""d"", flag = ""0"")),"
"0","  "
"0","  # Demographics - with realistic age distribution for credit applicants"
"0","  age = pmax(18, pmin(80, round(rnorm(n, 38, 13)))),"
"0","  income = pmax(12000, round(rlnorm(n, log(52000), 0.8))),"
"0","  employment_length = pmax(0, round(rexp(n, 1/6))),  # Exponential distribution for job tenure"
"0","  home_ownership = sample(c(""RENT"", ""MORTGAGE"", ""OWN""), n, replace = TRUE, prob = c(0.45, 0.40, 0.15)),"
"0","  "
"0","  # Loan characteristics - with more realistic correlations"
"0","  loan_amount = round(rlnorm(n, log(15000), 0.7) / 100) * 100,  # Log-normal for loan amounts"
"0","  loan_term = sample(c(36, 60, 120), n, replace = TRUE, prob = c(0.6, 0.3, 0.1)),"
"0","  "
"0","  # Credit history - with more realistic distributions"
"0","  credit_score = round(pmin(850, pmax(300, rnorm(n, 700, 90)))),"
"0","  dti_ratio = pmax(0, pmin(65, rlnorm(n, log(20), 0.4))),  # Debt-to-income ratio"
"0","  delinq_2yrs = rpois(n, 0.4),  # Number of delinquencies in past 2 years"
"0","  inq_last_6mths = rpois(n, 0.7),  # Number of inquiries in last 6 months"
"0","  open_acc = pmax(1, round(rnorm(n, 10, 4))),  # Number of open accounts"
"0","  pub_rec = rbinom(n, 2, 0.06),  # Number of public records"
"0","  revol_util = pmin(100, pmax(0, rnorm(n, 40, 20))),  # Revolving utilization"
"0","  total_acc = pmax(open_acc, open_acc + round(rnorm(n, 8, 6)))  # Total accounts"
"0",")"
"0",""
"0","# Add realistic correlations between variables"
"0","data <- data %>%"
"0","  mutate("
"0","    # Interest rate depends on credit score and loan term"
"0","    interest_rate = 25 - (credit_score - 300) * (15/550) + "
"0","      ifelse(loan_term == 36, -1, ifelse(loan_term == 60, 0, 1.5)) +"
"0","      rnorm(n, 0, 1.5),"
"0","    "
"0","    # Loan purpose with realistic probabilities"
"0","    loan_purpose = sample("
"0","      c(""debt_consolidation"", ""credit_card"", ""home_improvement"", ""major_purchase"", ""medical"", ""other""), "
"0","      n, replace = TRUE, "
"0","      prob = c(0.45, 0.25, 0.10, 0.08, 0.07, 0.05)"
"0","    ),"
"0","    "
"0","    # Add some derived features that have predictive power"
"0","    payment_amount = (loan_amount * (interest_rate/100/12) * (1 + interest_rate/100/12)^loan_term) / "
"0","      ((1 + interest_rate/100/12)^loan_term - 1),"
"0","    payment_to_income_ratio = (payment_amount * 12) / income"
"0","  )"
"0",""
"0","# Create a more realistic default probability model with non-linear effects"
"0","logit_default <- with(data, {"
"0","  -4.5 +  # Base intercept for ~10% default rate"
"0","    -0.03 * (age - 18) +  # Age effect (stronger for younger borrowers)"
"0","    -0.2 * log(income/10000) +  # Log-transformed income effect"
"0","    -0.08 * employment_length +  # Employment length effect"
"0","    ifelse(home_ownership == ""OWN"", -0.7, ifelse(home_ownership == ""MORTGAGE"", -0.3, 0)) +  # Home ownership"
"0","    0.3 * log(loan_amount/1000) +  # Log-transformed loan amount"
"0","    ifelse(loan_term == 36, 0, ifelse(loan_term == 60, 0.4, 0.8)) +  # Loan term"
"0","    0.15 * interest_rate +  # Interest rate effect"
"0","    ifelse(loan_purpose == ""debt_consolidation"", 0.5, "
"0","           ifelse(loan_purpose == ""credit_card"", 0.4, "
"0","                  ifelse(loan_purpose == ""medical"", 0.6, 0))) +  # Loan purpose"
"0","    -0.01 * (credit_score - 300) +  # Credit score (stronger effect at lower scores)"
"0","    0.06 * dti_ratio +  # DTI ratio effect"
"0","    0.4 * delinq_2yrs +  # Delinquencies effect (stronger effect for first delinquency)"
"0","    0.3 * inq_last_6mths +  # Inquiries effect"
"0","    -0.1 * log(open_acc + 1) +  # Open accounts (log-transformed)"
"0","    0.8 * pub_rec +  # Public records (strong effect)"
"0","    0.02 * revol_util +  # Revolving utilization"
"0","    1.2 * payment_to_income_ratio +  # Payment to income ratio (strong effect)"
"0","    rnorm(n, 0, 0.8)  # Add some noise for realistic variation"
"0","})"
"0",""
"0","# Generate default flag with realistic default rate"
"0","prob_default <- plogis(logit_default)"
"0","data$default <- factor(rbinom(n, 1, prob_default), levels = c(0, 1), labels = c(""no"", ""yes""))"
"0",""
"0","# Check class distribution"
"0","table(data$default)"
"1","
"
"1","  no "
"1"," yes "
"1","
"
"1","9425 "
"1"," 575 "
"1","
"
